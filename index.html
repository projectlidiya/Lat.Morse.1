<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Latihan Morse Video</title>

  <!-- FONT ESTETIK -->
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,500;0,700;1,600&family=Poppins:wght@400;600&display=swap" rel="stylesheet">

  <style>
    body{margin:0;font-family:Poppins,sans-serif;background:radial-gradient(#4b2e1e,#1c0f08);min-height:100vh;display:flex;justify-content:center;}
    .app{max-width:420px;width:100%;padding:20px;color:#fff}
    .card{background:#f7f2eb;color:#3a2418;border-radius:18px;padding:16px;margin-bottom:16px;box-shadow:0 10px 25px rgba(0,0,0,.35);}
    h1,h2,h3{text-align:center;margin-top:0}
    input,button{width:100%;padding:14px;border-radius:10px;border:none;font-size:16px;box-sizing:border-box;margin-bottom:10px;}
    input{border:1px solid #ccc}
    button{background:linear-gradient(135deg,#7a4a2e,#a36a3f);color:#fff;cursor:pointer;font-weight:600;}
    button.secondary{background:#8b3a2b}
    button:disabled{opacity:.6;cursor:not-allowed}
    .hidden{display:none}
    .top{display:flex;justify-content:space-between;font-weight:600;margin-bottom:10px}
    video{width:100%;border-radius:12px;margin:10px 0;background:#000}
    #motivasi{font-family:"Playfair Display",serif;font-size:18px;font-style:italic;text-align:center;line-height:1.7;margin-top:18px;color:#4b2e1e;}
  </style>
</head>
<body>
<div class="app">

<div id="start" class="card">
  <h2>Latihan Morse Video</h2>
  <div class="card" style="background:#efe6db">
    <h3>üìú Aturan Main</h3>
    <ul>
      <li>Setiap soal berupa video Morse (suara / cahaya)</li>
      <li>Waktu per soal 3 menit, jawaban otomatis terkunci</li>
      <li>Jawaban diketik manual, tidak bisa diubah setelah waktu habis</li>
      <li>Penilaian: 1 huruf benar = 1 poin</li>
      <li>Spasi wajib diketik tapi tidak dihitung skor</li>
      <li>Tidak menampilkan kunci jawaban</li>
      <li>Soal diacak, cocok untuk latihan berulang</li>
    </ul>
  </div>
  <input id="regu" placeholder="Nama Regu / Kontingen">
  <button id="btnMulai">‚ñ∂ MULAI</button>
</div>

<div id="game" class="hidden">
  <div class="top">
    <div id="timer">03:00</div>
    <div id="nomor">1 / 5</div>
  </div>
  <div class="card">
    <video id="video" controls muted playsinline></video>
    <input id="jawaban" placeholder="Ketik jawaban di sini">
    <button id="btnKirim">KIRIM</button>
  </div>
</div>

<div id="selesai" class="hidden card"></div>
</div>

<script>
const TOTAL_SOAL=5,WAKTU_SOAL=180;
const sClick=new Audio('sound/click.mp3'),sBenar=new Audio('sound/benar.mp3'),sSalah=new Audio('sound/salah.mp3'),backsound=new Audio('sound/backsound.mp3');
backsound.loop=true;backsound.volume=.3;
const kunci=['PRAMUKA SESUMATRA','KAMI SIAP MENOLSA SESAMA','BERSIH ITU SEHAT','MISI 4 SELESAI','HORMAT PEMIMPIN'];
const motivasiList=[
'‚Äú<b>Nikmati setiap fase naik dan turun</b> sebagai pengalaman berharga dalam hidupmu.‚Äù<br>‚Äî L, <i>keep growing</i>',
'‚Äú<b>Semakin sering kamu berlatih</b>, semakin banyak <b>motivasi</b> yang akan kamu dapatkan.‚Äù<br>‚Äî L, <i>keep growing</i>',
'‚ÄúLatihan hari ini adalah <b>pondasi kemenangan esok hari</b>.‚Äù<br>‚Äî AI',
'‚ÄúTidak apa-apa berjalan pelan, selama <b>arahmu tidak berubah</b>.‚Äù<br>‚Äî AI'
];
const startEl=document.getElementById('start'),gameEl=document.getElementById('game'),selesaiEl=document.getElementById('selesai'),video=document.getElementById('video'),jawabanEl=document.getElementById('jawaban'),timerEl=document.getElementById('timer'),nomorEl=document.getElementById('nomor');
let urutan=[],index=0,timer,skor=0,skorPerSoal=[],skorMaksPerSoal=[],skorMaksTotal=0,jawabanUser=[],namaRegu='';
document.getElementById('btnMulai').addEventListener('click',()=>{
  const regu=document.getElementById('regu').value.trim();
  if(!regu){alert('Isi nama regu dulu');return;}
  namaRegu=regu;
  try{sClick.currentTime=0;sClick.play()}catch(err){}
  urutan=[...Array(TOTAL_SOAL).keys()].sort(()=>Math.random()-.5);
  index=0;skor=0;jawabanUser=[];skorPerSoal=[];skorMaksPerSoal=[];skorMaksTotal=0;
  startEl.classList.add('hidden');gameEl.classList.remove('hidden');tampilSoal();
});
document.getElementById('btnKirim').addEventListener('click',kirim);
function tampilSoal(){
  nomorEl.textContent=`${index+1} / ${TOTAL_SOAL}`;
  jawabanEl.value='';jawabanEl.disabled=false;
  video.src=`video/${urutan[index]+1}.mp4`;
  video.load();video.play().catch(()=>{});
  mulaiTimer();
}
function mulaiTimer(){
  clearInterval(timer);
  let waktu=WAKTU_SOAL;
  timerEl.textContent=format(waktu);
  timer=setInterval(()=>{waktu--;timerEl.textContent=format(waktu);if(waktu<=0)kunciJawaban();},1e3);
}
function kirim(){clearInterval(timer);kunciJawaban();}
function kunciJawaban(){
  jawabanEl.disabled=true;
  const j=jawabanEl.value;
  const hasil=smartScore(j,kunci[urutan[index]]);
  skor+=hasil.score;
  skorPerSoal.push(hasil.score);
  skorMaksPerSoal.push(hasil.max);
  skorMaksTotal+=hasil.max;
  jawabanUser.push(hasil.detail||j);
  index++;index>=TOTAL_SOAL?selesai():tampilSoal();
}
function smartScore(uRaw,cRaw){
  const u=uRaw.toUpperCase(),c=cRaw.toUpperCase();
  const uc=u.replace(/[^A-Z0-9]/g,''),cc=c.replace(/[^A-Z0-9]/g,'');
  const max=cc.length;if(u.length===0)return{score:0,max,detail:uRaw};
  let score=0,highlighted='',idx=0;
  for(let ch of uRaw){
    if(/[A-Z0-9]/.test(ch)){if(idx<cc.length&&ch===cc[idx]){highlighted+=`<span style="color:green;font-weight:bold">${ch}</span>`;score++}else{highlighted+=`<span style="color:red;font-weight:bold">${ch}</span>`}idx++}else{highlighted+=ch}}
  score>0?sBenar.play():sSalah.play();
  return{score,max,detail:highlighted};
}
function selesai(){
  gameEl.classList.add('hidden');
  backsound.currentTime=0;backsound.play().catch(()=>{});
  let html=`<h2>üéâ Latihan Selesai</h2><p><b>Regu:</b> ${namaRegu}</p><h3>BENAR ${skor} POIN / ${skorMaksTotal}</h3>`;
  jawabanUser.forEach((j,i)=>{html+=`<div class="card"><p><b>Soal ${i+1}:</b> "${j||'-'}"</p><p><b>Skor:</b> ${skorPerSoal[i]} / ${skorMaksPerSoal[i]} poin</p></div>`});
  const quote=motivasiList[Math.floor(Math.random()*motivasiList.length)];
  html+=`<p id="motivasi">${quote}</p><button onclick="ulang()">üîÅ ULANGI LATIHAN</button>`;
  selesaiEl.innerHTML=html;selesaiEl.classList.remove('hidden');
}
function ulang(){backsound.pause();backsound.currentTime=0;selesaiEl.classList.add('hidden');startEl.classList.remove('hidden');document.getElementById('regu').value='';}
function format(d){return `${String(Math.floor(d/60)).padStart(2,'0')}:${String(d%60).padStart(2,'0')}`;}
</script>
</body>
</html>
